webpackJsonp([6],{477:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function E(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=a(25),o=n(s),_=a(43),i=n(_),S=a(196),c=n(S),d=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();a(26),a(45),a(197);var O=a(0),u=n(O),N=a(4),I=(n(N),a(16)),f=n(I),m=a(17),P=n(m),T=a(18),R=a(19),h=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}(R),p=(a(769),c.default.TabPane),L=function(e){function t(e){l(this,t);var a=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.payMonitor=function(){(0,T.axiosGet)(h.CheckPayed+"?t="+(new Date).getTime()+"&orderId="+a.props.orderId,!1,function(e){1==e.data.status&&(window.location.href="/success?msg=pay_success")}.bind(a))},a.handleBalancePay=function(){var e={payMethod:"balance",orderId:a.props.orderId};(0,T.axiosPost)(h.PayUrl,e,!0,function(e){1==e.data.status?i.default.success({title:"订单支付成功",content:"余额支付成功，可到个人中心查看订单状态",okText:"好的",onOk:function(){window.location.href="my#order"},onCancel:function(){window.location.href="my#order"}}):o.default.error(e.data.msg)})},a.handleTabChange=function(e,t){a.setState({current:e});var n={payMethod:e,orderId:a.props.orderId};switch(e){case"balance":var l={a:1};(0,T.axiosPost)(h.GetBalance,l,!0,function(e){1==e.data.status?(this.setState({balance:e.data.data}),parseFloat(e.data.data)<parseFloat(this.props.shouldPay)?(this.setState({enough:!1}),"boolean"==typeof t&&t&&this.handleTabChange("alipay",!0)):this.setState({enough:!0})):o.default.error(e.data.msg)}.bind(a));break;case"alipay":if(null!=a.state.qrAlipayImg)return;(0,T.axiosPost)(h.PayUrl,n,!0,function(e){1==e.data.status?this.setState({qrAlipayImg:e.data.data.qrImg}):o.default.error(e.data.msg)}.bind(a));break;case"wepay":if(null!=a.state.qrWepayImg)return;(0,T.axiosPost)(h.PayUrl,n,!0,function(e){1==e.data.status?this.setState({qrWepayImg:e.data.data.qrImg}):o.default.error(e.data.msg)}.bind(a))}},a.state={balance:"0.00",current:"balance",enough:!0,qrAlipayImg:null,qrWepayImg:null},a}return E(t,e),d(t,[{key:"componentDidMount",value:function(){document.title="收银台-优打印",setTimeout(function(){var e=window.setInterval(this.payMonitor,3e3);this.setState({monitor:e})}.bind(this),500)}},{key:"componentWillReceiveProps",value:function(e){e.canUseBalance?this.handleTabChange("balance",!0):this.handleTabChange("alipay",!0)}},{key:"componentWillUnmount",value:function(){window.clearInterval(this.state.monitor)}},{key:"render",value:function(){var e=u.default.createElement("div",{style:{fontWeight:"bold"}},"支付：",u.default.createElement("span",{style:{color:"#e4393c",fontSize:"18px"}},"￥",parseFloat(this.props.shouldPay).toFixed(2)));return u.default.createElement("div",{className:"cashier-info"},u.default.createElement("div",{className:"cashier-paymethod"},u.default.createElement("div",{className:"cashier-balance"},u.default.createElement("div",{className:"payment-list"},u.default.createElement(c.default,{activeKey:this.state.current,onChange:this.handleTabChange,tabBarExtraContent:e},this.props.canUseBalance?u.default.createElement(p,{tab:u.default.createElement("span",null,"余额支付"),key:"balance"},u.default.createElement("div",{className:"text-center"},u.default.createElement("div",{className:"balance-info margin-top-50"},"账户可用余额：￥",parseFloat(this.state.balance).toFixed(2)," ",this.state.enough?"":u.default.createElement("a",{href:"my#balance",target:"_black"},"(去充值)")),u.default.createElement("a",{type:"danger",className:"printButton margin-top-20",style:{width:"160px"},size:"large",onClick:this.handleBalancePay},"确定支付"))):null,u.default.createElement(p,{tab:u.default.createElement("span",null,"支付宝扫码"),key:"alipay"},u.default.createElement("div",{className:"text-center"},u.default.createElement("div",{className:"balance-info"},"请使用手机支付宝扫码支付，请勿重复支付"),u.default.createElement("img",{src:this.state.qrAlipayImg,style:{height:"180px",marginTop:"10px"}}))),u.default.createElement(p,{tab:u.default.createElement("span",null,"微信扫码",u.default.createElement("span",{className:"status-last",style:{backgroundColor:"red",marginLeft:"6px",fontSize:"13px",verticalAlign:"top"}},"随机立减")),key:"wepay"},u.default.createElement("div",{className:"text-center"},u.default.createElement("div",{className:"balance-info",style:{color:"red"}},"开学季活动非充值订单满1元使用微信支付，享随机立减，最高可免单！"),u.default.createElement("div",{className:"balance-info"},"请使用微信扫码支付，请勿重复支付"),u.default.createElement("img",{src:this.state.qrWepayImg,style:{height:"180px",marginTop:"10px"}}))))))))}}]),t}(u.default.Component),C=function(e){function t(e){l(this,t);for(var a,n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),E=n.props.location.search.replace("?",""),s=E.split("&"),o=0;o<s.length;o++)-1!=s[o].indexOf("orderId=")&&(a=s[o].replace("orderId=",""));return""==a&&(window.location.href="404"),n.state={orderId:a,shouldPay:"",orderData:{orderId:"",orderTime:"",orderInfo:"",shouldPay:0,canUseBalance:!1}},n}return E(t,e),d(t,[{key:"componentDidMount",value:function(){var e={orderId:this.state.orderId};(0,T.axiosPost)(h.GetOrderInfo,e,!0,function(e){1==e.data.status?this.setState({orderData:e.data.data,shouldPay:e.data.data.shouldPay}):window.location.href="404?msg=error_order_no"}.bind(this))}},{key:"render",value:function(){return u.default.createElement("div",null,u.default.createElement(f.default,{now:"cashier"}),u.default.createElement("section",{className:"sub-baner"},u.default.createElement("div",{className:"container"},u.default.createElement("div",{className:"h3-title"},"收银台"),u.default.createElement("ol",{className:"breadcrumb"},u.default.createElement("li",null,"上传文件"),u.default.createElement("li",null,"核对订单信息"),u.default.createElement("li",{className:"primary-color"},"付款")))),u.default.createElement("div",{id:"content"},u.default.createElement("section",{className:"padding-top-30 padding-bottom-100 min-width-700"},u.default.createElement("div",{className:"container"},u.default.createElement("div",{className:"row"},u.default.createElement("div",{className:"col-md-12"},u.default.createElement("div",{className:"cashier-panel"},u.default.createElement("div",{className:"cashier-title"},"付款信息"),u.default.createElement("div",{className:"cashier-info"},u.default.createElement("div",{className:"cashier-left"},u.default.createElement("div",{className:"cashier-goodsinfo"},u.default.createElement("div",{className:"cashier-subtitle"},"订单编号："),u.default.createElement("div",{className:"cashier-subinfo"},this.state.orderData.orderId)),u.default.createElement("div",{className:"cashier-goodsinfo"},u.default.createElement("div",{className:"cashier-subtitle"},"下单时间："),u.default.createElement("div",{className:"cashier-subinfo"},this.state.orderData.orderTime)),u.default.createElement("div",{className:"cashier-goodsinfo"},u.default.createElement("div",{className:"cashier-subtitle"},"订单信息："),u.default.createElement("div",{className:"cashier-subinfo"},this.state.orderData.orderInfo))),u.default.createElement("div",{className:"cashier-right"},u.default.createElement("div",{className:"cashier-payamount"},"应付金额：",u.default.createElement("span",null,"￥",parseFloat(this.state.orderData.shouldPay).toFixed(2)))))),u.default.createElement("div",{className:"cashier-panel"},u.default.createElement("div",{className:"cashier-title"},"付款方式"),u.default.createElement(L,{orderId:this.state.orderId,canUseBalance:this.state.orderData.canUseBalance,shouldPay:this.state.orderData.shouldPay}))))))),u.default.createElement(P.default,null))}}]),t}(u.default.Component);t.default=C},769:function(e,t){e.exports={O_RDONLY:0,O_WRONLY:1,O_RDWR:2,S_IFMT:61440,S_IFREG:32768,S_IFDIR:16384,S_IFCHR:8192,S_IFBLK:24576,S_IFIFO:4096,S_IFLNK:40960,S_IFSOCK:49152,O_CREAT:512,O_EXCL:2048,O_NOCTTY:131072,O_TRUNC:1024,O_APPEND:8,O_DIRECTORY:1048576,O_NOFOLLOW:256,O_SYNC:128,O_SYMLINK:2097152,O_NONBLOCK:4,S_IRWXU:448,S_IRUSR:256,S_IWUSR:128,S_IXUSR:64,S_IRWXG:56,S_IRGRP:32,S_IWGRP:16,S_IXGRP:8,S_IRWXO:7,S_IROTH:4,S_IWOTH:2,S_IXOTH:1,E2BIG:7,EACCES:13,EADDRINUSE:48,EADDRNOTAVAIL:49,EAFNOSUPPORT:47,EAGAIN:35,EALREADY:37,EBADF:9,EBADMSG:94,EBUSY:16,ECANCELED:89,ECHILD:10,ECONNABORTED:53,ECONNREFUSED:61,ECONNRESET:54,EDEADLK:11,EDESTADDRREQ:39,EDOM:33,EDQUOT:69,EEXIST:17,EFAULT:14,EFBIG:27,EHOSTUNREACH:65,EIDRM:90,EILSEQ:92,EINPROGRESS:36,EINTR:4,EINVAL:22,EIO:5,EISCONN:56,EISDIR:21,ELOOP:62,EMFILE:24,EMLINK:31,EMSGSIZE:40,EMULTIHOP:95,ENAMETOOLONG:63,ENETDOWN:50,ENETRESET:52,ENETUNREACH:51,ENFILE:23,ENOBUFS:55,ENODATA:96,ENODEV:19,ENOENT:2,ENOEXEC:8,ENOLCK:77,ENOLINK:97,ENOMEM:12,ENOMSG:91,ENOPROTOOPT:42,ENOSPC:28,ENOSR:98,ENOSTR:99,ENOSYS:78,ENOTCONN:57,ENOTDIR:20,ENOTEMPTY:66,ENOTSOCK:38,ENOTSUP:45,ENOTTY:25,ENXIO:6,EOPNOTSUPP:102,EOVERFLOW:84,EPERM:1,EPIPE:32,EPROTO:100,EPROTONOSUPPORT:43,EPROTOTYPE:41,ERANGE:34,EROFS:30,ESPIPE:29,ESRCH:3,ESTALE:70,ETIME:101,ETIMEDOUT:60,ETXTBSY:26,EWOULDBLOCK:35,EXDEV:18,SIGHUP:1,SIGINT:2,SIGQUIT:3,SIGILL:4,SIGTRAP:5,SIGABRT:6,SIGIOT:6,SIGBUS:10,SIGFPE:8,SIGKILL:9,SIGUSR1:30,SIGSEGV:11,SIGUSR2:31,SIGPIPE:13,SIGALRM:14,SIGTERM:15,SIGCHLD:20,SIGCONT:19,SIGSTOP:17,SIGTSTP:18,SIGTTIN:21,SIGTTOU:22,SIGURG:16,SIGXCPU:24,SIGXFSZ:25,SIGVTALRM:26,SIGPROF:27,SIGWINCH:28,SIGIO:23,SIGSYS:12,SSL_OP_ALL:2147486719,SSL_OP_ALLOW_UNSAFE_LEGACY_RENEGOTIATION:262144,SSL_OP_CIPHER_SERVER_PREFERENCE:4194304,SSL_OP_CISCO_ANYCONNECT:32768,SSL_OP_COOKIE_EXCHANGE:8192,SSL_OP_CRYPTOPRO_TLSEXT_BUG:2147483648,SSL_OP_DONT_INSERT_EMPTY_FRAGMENTS:2048,SSL_OP_EPHEMERAL_RSA:0,SSL_OP_LEGACY_SERVER_CONNECT:4,SSL_OP_MICROSOFT_BIG_SSLV3_BUFFER:32,SSL_OP_MICROSOFT_SESS_ID_BUG:1,SSL_OP_MSIE_SSLV2_RSA_PADDING:0,SSL_OP_NETSCAPE_CA_DN_BUG:536870912,SSL_OP_NETSCAPE_CHALLENGE_BUG:2,SSL_OP_NETSCAPE_DEMO_CIPHER_CHANGE_BUG:1073741824,SSL_OP_NETSCAPE_REUSE_CIPHER_CHANGE_BUG:8,SSL_OP_NO_COMPRESSION:131072,SSL_OP_NO_QUERY_MTU:4096,SSL_OP_NO_SESSION_RESUMPTION_ON_RENEGOTIATION:65536,SSL_OP_NO_SSLv2:16777216,SSL_OP_NO_SSLv3:33554432,SSL_OP_NO_TICKET:16384,SSL_OP_NO_TLSv1:67108864,SSL_OP_NO_TLSv1_1:268435456,SSL_OP_NO_TLSv1_2:134217728,SSL_OP_PKCS1_CHECK_1:0,SSL_OP_PKCS1_CHECK_2:0,SSL_OP_SINGLE_DH_USE:1048576,SSL_OP_SINGLE_ECDH_USE:524288,SSL_OP_SSLEAY_080_CLIENT_DH_BUG:128,SSL_OP_SSLREF2_REUSE_CERT_TYPE_BUG:0,SSL_OP_TLS_BLOCK_PADDING_BUG:512,SSL_OP_TLS_D5_BUG:256,SSL_OP_TLS_ROLLBACK_BUG:8388608,ENGINE_METHOD_DSA:2,ENGINE_METHOD_DH:4,ENGINE_METHOD_RAND:8,ENGINE_METHOD_ECDH:16,ENGINE_METHOD_ECDSA:32,ENGINE_METHOD_CIPHERS:64,ENGINE_METHOD_DIGESTS:128,ENGINE_METHOD_STORE:256,ENGINE_METHOD_PKEY_METHS:512,ENGINE_METHOD_PKEY_ASN1_METHS:1024,ENGINE_METHOD_ALL:65535,ENGINE_METHOD_NONE:0,DH_CHECK_P_NOT_SAFE_PRIME:2,DH_CHECK_P_NOT_PRIME:1,DH_UNABLE_TO_CHECK_GENERATOR:4,DH_NOT_SUITABLE_GENERATOR:8,NPN_ENABLED:1,RSA_PKCS1_PADDING:1,RSA_SSLV23_PADDING:2,RSA_NO_PADDING:3,RSA_PKCS1_OAEP_PADDING:4,RSA_X931_PADDING:5,RSA_PKCS1_PSS_PADDING:6,POINT_CONVERSION_COMPRESSED:2,POINT_CONVERSION_UNCOMPRESSED:4,POINT_CONVERSION_HYBRID:6,F_OK:0,R_OK:4,W_OK:2,X_OK:1,UV_UDP_REUSEADDR:4}}});